//----------------------------------------------------------------------------------------------------;

// DATEBASE;

//----------------------------------------------------------------------------------------------------;

var db0 = db.getSiblingDB("daily_master_h5");

//----------------------------------------------------------------------------------------------------;

// COLLECTION;

//----------------------------------------------------------------------------------------------------;

var col0 = db0.getCollection( "daily_master" );
var col1 = db0.getCollection( "daily_master__update_20190930" );

//----------------------------------------------------------------------------------------------------;

// CREATEINDEX;

//----------------------------------------------------------------------------------------------------;


col0.createIndex({ date : 1, goods_id : 1})

//----------------------------------------------------------------------------------------------------;

// QUERY;

//----------------------------------------------------------------------------------------------------;

var _q0 =  {};
var _q1 = { date : null, goods_id : null};

var _s0 = { Daily_Sales : null }

//----------------------------------------------------------------------------------------------------;

// FUNCTION;

//----------------------------------------------------------------------------------------------------;

var FN = function(){

	var idx = 0;
	var totalCount = col1.count();

	col1.find( _q0 ).forEach(function( item ){
		print( "-------------------------------------------------------" );
		print( idx + " / " + totalCount + " - " + Date() );
		print( "-------------------------------------------------------" );

		_q1.date = item.date;
		_q1.goods_id = item.goods_id;
		_s0.Daily_Sales = item.Daily_Sales;
		col0.updateOne( _q1, { $set : _s0 } );
		++idx;
	})
};

//----------------------------------------------------------------------------------------------------;

// LOGIC;

//----------------------------------------------------------------------------------------------------;

FN();

return;